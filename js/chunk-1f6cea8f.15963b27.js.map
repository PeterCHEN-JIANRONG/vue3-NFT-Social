{"version":3,"sources":["webpack:///./src/views/FrontEnd/PersonalView.vue?f0f0","webpack:///./src/components/PostEmptyCard.vue?4900","webpack:///./src/views/FrontEnd/PersonalView.vue","webpack:///./src/views/FrontEnd/PersonalView.vue?f5b2","webpack:///./src/components/icons/IconSearch.vue","webpack:///./src/components/PostFilter.vue","webpack:///./src/components/PostFilter.vue?ae63","webpack:///./src/components/PostEmptyCard.vue","webpack:///./src/components/PostEmptyCard.vue?c056"],"names":["userStore","useUserStore","axios","inject","Swal","posts","ref","isLoading","route","useRoute","userId","params","id","getPersonalPosts","sort","searchKey","sortValue","value","url","process","get","then","res","data","catch","err","fire","errorAlertConstruct","response","message","onMounted","deletePost","postId","index","findIndex","i","_id","splice","profile","getProfile","console","log","followLoading","follow","post","followers","push","user","createdAt","Date","toISOString","unFollow","delete","watch","curr","name","__exports__","getPosts","emit","class","_createElementVNode","_createElementBlock","_hoisted_2","_renderSlot","_ctx","undefined","script","render"],"mappings":"kHAAA,W,oCCAA,W,wiCCmFA,IAAMA,EAAYC,iBACZC,EAAQC,oBAAO,SACfC,EAAOD,oBAAO,SACdE,EAAQC,iBAAI,IACZC,EAAYD,kBAAI,GAChBE,EAAQC,iBACRC,EAASJ,iBAAIE,EAAMG,OAAOC,IAG1BC,EAAmB,WAA8B,IAA7BC,EAA6B,uDAAtB,EAAGC,EAAmB,uDAAP,GAE1CC,EAAY,OACH,IAATF,IACFE,EAAY,OAGdT,EAAUU,OAAQ,EAClB,IAAMC,EAAM,GAAH,OAAMC,yCAAN,uBAA4CT,EAAOO,MAAnD,qBAAqED,EAArE,cAAoFD,GAC7Fb,EACGkB,IAAIF,GACJG,MAAK,SAACC,GACLjB,EAAMY,MAAQK,EAAIC,KAAKA,KACvBhB,EAAUU,OAAQ,KAEnBO,OAAM,SAACC,GACNlB,EAAUU,OAAQ,EAClBb,EAAKsB,KAAKC,iCAAoB,KAAMF,EAAIG,SAASL,KAAKM,cAG5DC,wBAAU,WACRjB,OAIF,IAAMkB,EAAa,SAACC,GAClB,IAAMC,EAAQ5B,EAAMY,MAAMiB,WAAU,SAACC,GAAD,OAAOA,EAAEC,MAAQJ,KACrD3B,EAAMY,MAAMoB,OAAOJ,EAAO,IAItBK,EAAUhC,iBAAI,IACdiC,EAAa,WACjB,IAAMrB,EAAM,GAAH,OAAMC,yCAAN,iBAAsCT,EAAOO,MAA7C,YACTf,EACGkB,IAAIF,GACJG,MAAK,SAACC,GACLgB,EAAQrB,MAAQK,EAAIC,KAAKA,QAE1BC,OAAM,SAACC,GACNe,QAAQC,IAAIhB,OAGlBK,wBAAU,WACRS,OAIF,IAAMG,EAAgBpC,kBAAI,GACpBqC,EAAS,WACbD,EAAczB,OAAQ,EACtB,IAAMC,EAAM,GAAH,OAAMC,yCAAN,iBAAsCT,EAAOO,MAA7C,WACTf,EACG0C,KAAK1B,GACLG,MAAK,WACJqB,EAAczB,OAAQ,EACtBqB,EAAQrB,MAAM4B,UAAUC,KAAK,CAC3BC,KAAM/C,EAAU+C,KAAKX,IACrBY,WAAW,IAAIC,MAAOC,mBAGzB1B,OAAM,SAACC,GACNiB,EAAczB,OAAQ,EACtBuB,QAAQC,IAAIhB,OAKZ0B,EAAW,WACfT,EAAczB,OAAQ,EACtB,IAAMC,EAAM,GAAH,OAAMC,yCAAN,iBAAsCT,EAAOO,MAA7C,WACTf,EACGkD,OAAOlC,GACPG,MAAK,WACJqB,EAAczB,OAAQ,EACtB,IAAMgB,EAAQK,EAAQrB,MAAM4B,UAAUX,WACpC,SAACC,GAAD,OAAOA,EAAEY,OAAS/C,EAAU+C,KAAKX,OAEnCE,EAAQrB,MAAM4B,UAAUR,OAAOJ,EAAO,MAEvCT,OAAM,SAACC,GACNiB,EAAczB,OAAQ,EACtBuB,QAAQC,IAAIhB,O,OAKlB4B,mBAAM7C,GAAO,SAAC8C,GACM,QAAdA,EAAKC,MAAkBD,EAAK3C,OAAOC,KACrCF,EAAOO,MAAQqC,EAAK3C,OAAOC,GAC3BC,IACA0B,Q,y8ECjLJ,MAAMiB,EAA2B,IAAgB,EAAQ,CAAC,CAAC,YAAY,qBAExD,gB,siBCLf,MAAMA,EAAc,EAEL,Q,+UCiCTzC,EAAYT,iBAAI,IAChBQ,EAAOR,iBAAI,GAEXmD,EAAW,WACfC,EAAK,YAAa5C,EAAKG,MAAOF,EAAUE,Q,g7BCvC1C,MAAM,EAAc,EAEL,U,yJCJR0C,MAAM,qD,uBACTC,gCAEM,OAFDD,MAAM,0CAAwC,CACjDC,gCAAyB,QAAnBD,MAAM,UADd,M,gDADFE,gCAKM,MALN,EAKM,CAJJC,EAGAC,wBAAaC,SAAA,kBAAAC,GAAA,K,mCCJjB,MAAMC,EAAS,GAKTV,EAA2B,IAAgBU,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAE1E","file":"js/chunk-1f6cea8f.15963b27.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./PersonalView.vue?vue&type=style&index=0&id=30948ce0&lang=scss&scoped=true\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./PostEmptyCard.vue?vue&type=style&index=0&id=48e767d6&lang=scss&scoped=true\"","<template>\n  <Loading :active=\"isLoading\" :z-index=\"1060\" />\n  <div class=\"follow bg-white d-flex border border-2 border-dark mb-3\">\n    <div class=\"follow__img\">\n      <img\n        v-if=\"profile.photo\"\n        :src=\"profile.photo\"\n        :alt=\"profile.name\"\n        class=\"h-6s h-md-7s img-cover border-end border-2 border-dark\"\n      />\n      <img\n        v-else\n        src=\"@/assets/avatars/user_default.png\"\n        class=\"h-6s h-md-7s img-cover border-end border-2 border-dark\"\n      />\n    </div>\n    <div\n      class=\"flex-grow-1 d-flex justify-content-between align-items-center p-3\"\n    >\n      <div>\n        <p class=\"fw-bold mb-1\">{{ profile.name }}</p>\n        <p class=\"mb-0\">{{ profile.followers?.length }} 人追蹤</p>\n      </div>\n      <div v-if=\"userId !== userStore.user?._id\">\n        <button\n          v-if=\"!profile.followers?.some((i) => i.user === userStore.user?._id)\"\n          type=\"button\"\n          class=\"btn btn-warning fw-bold border border-2 border-dark rounded-3 shadow__follow px-3 px-md-5 py-1\"\n          @click=\"follow\"\n        >\n          <span\n            v-show=\"followLoading\"\n            class=\"spinner-border spinner-border-sm\"\n            role=\"status\"\n            aria-hidden=\"true\"\n          ></span>\n          追蹤\n        </button>\n        <button\n          v-else\n          type=\"button\"\n          class=\"btn btn-light fw-bold border border-2 border-dark rounded-3 shadow__follow px-3 px-md-5 py-1\"\n          @click=\"unFollow\"\n        >\n          <span\n            v-show=\"followLoading\"\n            class=\"spinner-border spinner-border-sm\"\n            role=\"status\"\n            aria-hidden=\"true\"\n          ></span>\n          取消追蹤\n        </button>\n      </div>\n    </div>\n  </div>\n  <PostFilter @get-posts=\"getPersonalPosts\" />\n  <PostEmptyCard v-if=\"posts.length === 0\">\n    <p class=\"text-center text-muted mb-0 p-4\">\n      目前尚無動態，新增一則貼文吧！\n    </p>\n  </PostEmptyCard>\n  <ul v-else>\n    <li\n      v-for=\"(item, index) in posts\"\n      :key=\"item._id\"\n      :class=\"{ 'mb-3': index < posts.length - 1 }\"\n    >\n      <PostCard :post=\"item\" @delete-after=\"deletePost\" />\n    </li>\n  </ul>\n</template>\n\n<script setup>\nimport {\n  ref, inject, onMounted, watch,\n} from 'vue';\nimport { useRoute } from 'vue-router';\nimport PostCard from '@/components/PostCard.vue';\nimport PostEmptyCard from '@/components/PostEmptyCard.vue';\nimport PostFilter from '@/components/PostFilter.vue';\nimport { errorAlertConstruct } from '@/utils/alertConstructHandle';\nimport useUserStore from '@/stores/user';\n\nconst userStore = useUserStore();\nconst axios = inject('axios'); // inject axios\nconst Swal = inject('$swal');\nconst posts = ref([]);\nconst isLoading = ref(false);\nconst route = useRoute();\nconst userId = ref(route.params.id); // 此頁面用戶 ID\n\n// 取得個人貼文\nconst getPersonalPosts = (sort = 1, searchKey = '') => {\n  // sort -> 1:desc, 2:asc\n  let sortValue = 'desc'; // 預設 desc\n  if (sort === 2) {\n    sortValue = 'asc';\n  }\n\n  isLoading.value = true;\n  const url = `${process.env.VUE_APP_API}/posts/user/${userId.value}?timeSort=${sortValue}&q=${searchKey}`;\n  axios\n    .get(url)\n    .then((res) => {\n      posts.value = res.data.data;\n      isLoading.value = false;\n    })\n    .catch((err) => {\n      isLoading.value = false;\n      Swal.fire(errorAlertConstruct('失敗', err.response.data.message));\n    });\n};\nonMounted(() => {\n  getPersonalPosts();\n});\n\n// 刪除一個 Post, 可不用重新 getPersonalPosts\nconst deletePost = (postId) => {\n  const index = posts.value.findIndex((i) => i._id === postId);\n  posts.value.splice(index, 1);\n};\n\n// 取得個人資料\nconst profile = ref({});\nconst getProfile = () => {\n  const url = `${process.env.VUE_APP_API}/user/${userId.value}/profile`;\n  axios\n    .get(url)\n    .then((res) => {\n      profile.value = res.data.data;\n    })\n    .catch((err) => {\n      console.log(err);\n    });\n};\nonMounted(() => {\n  getProfile();\n});\n\n// 追蹤\nconst followLoading = ref(false);\nconst follow = () => {\n  followLoading.value = true;\n  const url = `${process.env.VUE_APP_API}/user/${userId.value}/follow`;\n  axios\n    .post(url)\n    .then(() => {\n      followLoading.value = false;\n      profile.value.followers.push({\n        user: userStore.user._id,\n        createdAt: new Date().toISOString(),\n      });\n    })\n    .catch((err) => {\n      followLoading.value = false;\n      console.log(err);\n    });\n};\n\n// 取消追蹤\nconst unFollow = () => {\n  followLoading.value = true;\n  const url = `${process.env.VUE_APP_API}/user/${userId.value}/follow`;\n  axios\n    .delete(url)\n    .then(() => {\n      followLoading.value = false;\n      const index = profile.value.followers.findIndex(\n        (i) => i.user === userStore.user._id,\n      );\n      profile.value.followers.splice(index, 1);\n    })\n    .catch((err) => {\n      followLoading.value = false;\n      console.log(err);\n    });\n};\n\n// 相同路由 /profile/:id, id 參數切換\nwatch(route, (curr) => {\n  if (curr.name === '個人頁' && curr.params.id) {\n    userId.value = curr.params.id;\n    getPersonalPosts();\n    getProfile();\n  }\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.follow {\n  position: relative;\n  border-radius: 8px;\n  &::after {\n    content: '';\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    background-color: #fff;\n    border: 2px solid #000040;\n    border-radius: 8px;\n    top: 2px;\n    right: 2px;\n    z-index: -1;\n    box-sizing: content-box;\n  }\n\n  &__img {\n    border-top-left-radius: 8px;\n    border-bottom-left-radius: 8px;\n    overflow: hidden;\n  }\n}\n</style>\n","import script from \"./PersonalView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./PersonalView.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./PersonalView.vue?vue&type=style&index=0&id=30948ce0&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\peter.chen\\\\Documents\\\\myProject\\\\node直播班\\\\vue3-NFT-Social\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-30948ce0\"]])\n\nexport default __exports__","import script from \"./IconSearch.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./IconSearch.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\n  <div class=\"row gx-3 gy-2 mb-3\">\n    <div class=\"col-md-4\">\n      <select\n        class=\"form-select border border-2 border-dark\"\n        v-model.number=\"sort\"\n        @change=\"getPosts\"\n      >\n        <option value=\"1\">最新貼文</option>\n        <option value=\"2\">最舊貼文</option>\n      </select>\n    </div>\n    <div class=\"col-md-8\">\n      <div class=\"input-group border border-2 border-dark\">\n        <input\n          type=\"text\"\n          class=\"form-control border-0\"\n          placeholder=\"搜尋貼文\"\n          v-model=\"searchKey\"\n          @keyup.enter=\"getPosts\"\n        />\n        <button\n          class=\"btn btn-primary border-top-0 border-end-0 border-bottom-0 border-2 border-dark\"\n          type=\"button\"\n          @click=\"getPosts\"\n        >\n          <IconSearch />\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref } from 'vue';\nimport IconSearch from '@/components/icons/IconSearch.vue';\n\nconst emit = defineEmits(['get-posts']);\nconst searchKey = ref('');\nconst sort = ref(1);\n\nconst getPosts = () => {\n  emit('get-posts', sort.value, searchKey.value);\n};\n</script>\n","import script from \"./PostFilter.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./PostFilter.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\n  <div class=\"bg-white shadow__post border border-2 border-dark\">\n    <div class=\"border-bottom border-2 border-dark p-3\">\n      <span class=\"dot\"></span>\n    </div>\n    <slot></slot>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.dot,\n.dot::before,\n.dot::after {\n  height: 9px;\n  width: 9px;\n  border-radius: 50%;\n  display: inline-block;\n}\n.dot {\n  background-color: #de4b63;\n  position: relative;\n  &::before {\n    content: '';\n    background-color: #faa722;\n    position: absolute;\n    left: 150%;\n  }\n  &::after {\n    content: '';\n    background-color: #83c51d;\n    position: absolute;\n    left: 300%;\n  }\n}\n</style>\n","import { render } from \"./PostEmptyCard.vue?vue&type=template&id=48e767d6&scoped=true\"\nconst script = {}\n\nimport \"./PostEmptyCard.vue?vue&type=style&index=0&id=48e767d6&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\peter.chen\\\\Documents\\\\myProject\\\\node直播班\\\\vue3-NFT-Social\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-48e767d6\"]])\n\nexport default __exports__"],"sourceRoot":""}