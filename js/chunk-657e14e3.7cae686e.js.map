{"version":3,"sources":["webpack:///./src/views/FrontEnd/ProfileView.vue","webpack:///./src/views/FrontEnd/ProfileView.vue?f805","webpack:///./src/assets/avatars/user_default.png","webpack:///./src/components/TittleBlock.vue","webpack:///./node_modules/core-js/modules/es.function.name.js","webpack:///./src/components/TittleBlock.vue?aeb8","webpack:///./src/stores/user.js","webpack:///./src/utils/alertConstructHandle.js","webpack:///./src/views/FrontEnd/ProfileView.vue?31d7"],"names":["userStore","useUserStore","Swal","inject","axios","isLoading","ref","sheet","user","getProfile","value","url","process","get","then","res","data","sex","catch","err","fire","errorAlertConstruct","response","message","onMounted","modifyProfile","patch","updateUser","successAlertConstruct","form2","passwordData","modifyPassword","password","confirmPassword","document","querySelector","focus","resetForm","token","localStorage","setItem","avatar","uploading","uploadAvatar","formData","FormData","append","files","headers","post","photo","__exports__","module","exports","DESCRIPTORS","FUNCTION_NAME_EXISTS","EXISTS","uncurryThis","defineProperty","f","FunctionPrototype","Function","prototype","functionToString","toString","nameRE","regExpExec","exec","NAME","configurable","this","error","defineStore","state","actions","obj","title","text","position","icon","showConfirmButton","timer"],"mappings":"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","file":"js/chunk-657e14e3.7cae686e.js","sourcesContent":["<template>\n  <Loading :active=\"isLoading\" :z-index=\"1060\" />\n  <TittleBlock tittle=\"修改個人資料\" class=\"mb-5\" />\n  <ul class=\"nav nav-tabs\">\n    <li class=\"nav-item\">\n      <a\n        class=\"nav-link\"\n        href=\"#\"\n        :class=\"{ active: sheet === 1 }\"\n        @click.prevent=\"sheet = 1\"\n        >修改暱稱</a\n      >\n    </li>\n    <li class=\"nav-item\">\n      <a\n        class=\"nav-link\"\n        href=\"#\"\n        :class=\"{ active: sheet === 2 }\"\n        @click.prevent=\"sheet = 2\"\n        >重設密碼</a\n      >\n    </li>\n  </ul>\n  <div\n    class=\"bg-white row justify-content-center border border-2 border-dark rounded-3 p-4\"\n  >\n    <div class=\"col-md-8\">\n      <div v-if=\"sheet === 1\" class=\"mb-3\">\n        <div class=\"mb-3 text-center\">\n          <img\n            v-if=\"user.photo\"\n            :src=\"user.photo\"\n            class=\"h-7s w-7s img-cover border border-2 border-dark rounded-circle\"\n            alt=\"大頭照\"\n          />\n          <img\n            v-else\n            src=\"@/assets/avatars/user_default.png\"\n            class=\"h-7s w-7s img-cover\"\n            alt=\"大頭照\"\n          />\n        </div>\n        <label for=\"formFile\" class=\"form-label\"\n          >大頭照\n          <span\n            v-show=\"uploading\"\n            class=\"spinner-border spinner-border-sm\"\n            role=\"status\"\n          ></span>\n        </label>\n        <input\n          type=\"file\"\n          id=\"formFile\"\n          class=\"form-control\"\n          ref=\"avatar\"\n          @change=\"uploadAvatar\"\n        />\n      </div>\n      <Form\n        v-if=\"sheet === 1\"\n        ref=\"form1\"\n        class=\"\"\n        v-slot=\"{ errors }\"\n        @submit=\"modifyProfile\"\n      >\n        <div class=\"mb-3\">\n          <label for=\"name\" class=\"form-label mb-1\"\n            >暱稱<span class=\"text-danger\">*</span>\n          </label>\n          <Field\n            id=\"name\"\n            name=\"暱稱\"\n            type=\"text\"\n            class=\"form-control border border-2 border-dark\"\n            :class=\"{ 'is-invalid': errors['暱稱'] }\"\n            placeholder=\"請輸入暱稱\"\n            v-model.trim=\"user.name\"\n            rules=\"required\"\n          />\n          <ErrorMessage name=\"暱稱\" class=\"invalid-feedback\" />\n        </div>\n\n        <ul class=\"mb-4\">\n          <h3 class=\"fw-normal fs-6 mb-1\">\n            性別<span class=\"text-danger\">*</span>\n          </h3>\n          <li class=\"form-check form-check-inline\">\n            <input\n              class=\"form-check-input\"\n              type=\"radio\"\n              name=\"性別\"\n              id=\"radio1\"\n              value=\"male\"\n              v-model=\"user.sex\"\n            />\n            <label class=\"form-check-label\" for=\"radio1\">男性</label>\n          </li>\n          <li class=\"form-check form-check-inline\">\n            <input\n              class=\"form-check-input\"\n              type=\"radio\"\n              name=\"性別\"\n              id=\"radio2\"\n              value=\"female\"\n              v-model=\"user.sex\"\n            />\n            <label class=\"form-check-label\" for=\"radio2\">女性</label>\n          </li>\n        </ul>\n\n        <div class=\"\">\n          <button\n            type=\"submit\"\n            class=\"post__btn btn btn-primary btn-lg w-100 shadow__btn border border-2 border-dark rounded-3\"\n            :disabled=\"Object.keys(errors).length > 0\"\n          >\n            更新\n          </button>\n        </div>\n      </Form>\n      <Form\n        v-if=\"sheet === 2\"\n        ref=\"form2\"\n        class=\"\"\n        v-slot=\"{ errors }\"\n        @submit=\"modifyPassword\"\n      >\n        <div class=\"mb-3\">\n          <label for=\"password\" class=\"form-label mb-1\"\n            >輸入新密碼<span class=\"text-danger\">*</span>\n          </label>\n          <Field\n            id=\"password\"\n            name=\"密碼\"\n            type=\"password\"\n            class=\"form-control border border-2 border-dark\"\n            :class=\"{ 'is-invalid': errors['密碼'] }\"\n            placeholder=\"請輸入密碼\"\n            v-model.trim=\"passwordData.password\"\n            rules=\"required|min:8\"\n          />\n          <ErrorMessage name=\"密碼\" class=\"invalid-feedback\" />\n        </div>\n        <div class=\"mb-3\">\n          <label for=\"confirmPassword\" class=\"form-label mb-1\"\n            >確認密碼<span class=\"text-danger\">*</span>\n          </label>\n          <Field\n            id=\"confirmPassword\"\n            name=\"確認密碼\"\n            type=\"password\"\n            class=\"form-control border border-2 border-dark\"\n            :class=\"{ 'is-invalid': errors['確認密碼'] }\"\n            placeholder=\"請輸入確認密碼\"\n            v-model.trim=\"passwordData.confirmPassword\"\n            rules=\"required|min:8\"\n          />\n          <ErrorMessage name=\"確認密碼\" class=\"invalid-feedback\" />\n        </div>\n\n        <div class=\"\">\n          <button\n            type=\"submit\"\n            class=\"post__btn btn btn-primary btn-lg w-100 shadow__btn border border-2 border-dark rounded-3\"\n            :disabled=\"Object.keys(errors).length > 0\"\n          >\n            更新密碼\n          </button>\n        </div>\n      </Form>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, inject, onMounted } from 'vue';\nimport {\n  errorAlertConstruct,\n  successAlertConstruct,\n} from '@/utils/alertConstructHandle';\nimport useUserStore from '@/stores/user';\nimport TittleBlock from '@/components/TittleBlock.vue';\n\nconst userStore = useUserStore();\nconst Swal = inject('$swal');\nconst axios = inject('axios'); // inject axios\nconst isLoading = ref(false);\nconst sheet = ref(1); // 1:修改暱稱 2:重設密碼\n\n// 修改暱稱\nconst user = ref({});\nconst getProfile = () => {\n  isLoading.value = true;\n  const url = `${process.env.VUE_APP_API}/user/profile`;\n  axios\n    .get(url)\n    .then((res) => {\n      isLoading.value = false;\n      user.value = res.data.user;\n      if (!user.value.sex) {\n        user.value.sex = 'male';\n      }\n    })\n    .catch((err) => {\n      isLoading.value = false;\n      Swal.fire(errorAlertConstruct('失敗', err.response.data.message));\n    });\n};\nonMounted(() => {\n  getProfile();\n});\n\nconst modifyProfile = () => {\n  isLoading.value = true;\n  const url = `${process.env.VUE_APP_API}/user/profile`;\n\n  axios\n    .patch(url, user.value)\n    .then((res) => {\n      isLoading.value = false;\n      userStore.updateUser(res.data.user);\n      Swal.fire(successAlertConstruct('成功', '個人資料更新成功'));\n      getProfile();\n    })\n    .catch((err) => {\n      isLoading.value = false;\n      Swal.fire(errorAlertConstruct('失敗', err.response.data.message));\n    });\n};\n\n// 重設密碼\nconst form2 = ref(null);\nconst passwordData = ref({});\nconst modifyPassword = () => {\n  if (passwordData.value.password !== passwordData.value.confirmPassword) {\n    document.querySelector('#password').focus();\n    Swal.fire(errorAlertConstruct('失敗', '密碼不一致！'));\n    return;\n  }\n\n  isLoading.value = true;\n  const url = `${process.env.VUE_APP_API}/user/updatePassword`;\n  axios\n    .patch(url, passwordData.value)\n    .then((res) => {\n      isLoading.value = false;\n      form2.value.resetForm();\n      const { token } = res.data.user;\n      localStorage.setItem('metaWall', token);\n      Swal.fire(successAlertConstruct('成功', '密碼更新成功'));\n    })\n    .catch((err) => {\n      isLoading.value = false;\n      Swal.fire(errorAlertConstruct('失敗', err.response.data.message));\n    });\n};\n\n// 上傳大頭照\nconst avatar = ref(null);\nconst uploading = ref(false);\nconst uploadAvatar = () => {\n  const formData = new FormData();\n  formData.append('avatar', avatar.value.files[0]);\n  const url = `${process.env.VUE_APP_API}/upload/avatar`;\n  const headers = {\n    'Content-Type': 'multipart/form-data',\n  };\n  uploading.value = true;\n  axios\n    .post(url, formData, { headers })\n    .then((res) => {\n      uploading.value = false;\n      user.value.photo = res.data.data;\n    })\n    .catch((err) => {\n      uploading.value = false;\n      Swal.fire(errorAlertConstruct('失敗', err.response.data.message));\n    });\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.nav {\n  .nav-item {\n    .nav-link {\n      color: #000400;\n      background: white;\n      border-top: 2px solid #000400;\n      border-left: 2px solid #000400;\n      border-right: 2px solid #000400;\n      border-bottom: 0;\n      border-top-left-radius: 8px;\n      border-top-right-radius: 8px;\n    }\n    .active {\n      color: white;\n      background: #000400;\n    }\n  }\n}\n\n.post__btn {\n  box-shadow: -2px 2px 0px #000400;\n  border-radius: 8px;\n  &:hover {\n    color: #000400;\n    background: #eec32a;\n  }\n}\n</style>\n","import script from \"./ProfileView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ProfileView.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ProfileView.vue?vue&type=style&index=0&id=18add9f6&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\peter.chen\\\\Documents\\\\myProject\\\\node直播班\\\\vue3-NFT-Social\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-18add9f6\"]])\n\nexport default __exports__","module.exports = __webpack_public_path__ + \"img/user_default.bb020d40.png\";","import script from \"./TittleBlock.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./TittleBlock.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./TittleBlock.vue?vue&type=style&index=0&id=6333d894&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\peter.chen\\\\Documents\\\\myProject\\\\node直播班\\\\vue3-NFT-Social\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-6333d894\"]])\n\nexport default __exports__","var DESCRIPTORS = require('../internals/descriptors');\nvar FUNCTION_NAME_EXISTS = require('../internals/function-name').EXISTS;\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar defineProperty = require('../internals/object-define-property').f;\n\nvar FunctionPrototype = Function.prototype;\nvar functionToString = uncurryThis(FunctionPrototype.toString);\nvar nameRE = /function\\b(?:\\s|\\/\\*[\\S\\s]*?\\*\\/|\\/\\/[^\\n\\r]*[\\n\\r]+)*([^\\s(/]*)/;\nvar regExpExec = uncurryThis(nameRE.exec);\nvar NAME = 'name';\n\n// Function instances `.name` property\n// https://tc39.es/ecma262/#sec-function-instances-name\nif (DESCRIPTORS && !FUNCTION_NAME_EXISTS) {\n  defineProperty(FunctionPrototype, NAME, {\n    configurable: true,\n    get: function () {\n      try {\n        return regExpExec(nameRE, functionToString(this))[1];\n      } catch (error) {\n        return '';\n      }\n    }\n  });\n}\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./TittleBlock.vue?vue&type=style&index=0&id=6333d894&lang=scss&scoped=true\"","import { defineStore } from 'pinia';\n\nexport default defineStore('user', {\n  state: () => ({\n    user: {},\n  }),\n  actions: {\n    updateUser(obj) {\n      this.user = obj;\n    },\n  },\n});\n","const errorAlertConstruct = (title, text = '') => ({\n  position: 'center',\n  icon: 'error',\n  title,\n  text,\n  showConfirmButton: false,\n  timer: 1500,\n});\n\nconst successAlertConstruct = (title, text = '') => ({\n  position: 'center',\n  icon: 'success',\n  title,\n  text,\n  showConfirmButton: false,\n  timer: 1500,\n});\n\nmodule.exports = {\n  errorAlertConstruct,\n  successAlertConstruct,\n};\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./ProfileView.vue?vue&type=style&index=0&id=18add9f6&lang=scss&scoped=true\""],"sourceRoot":""}